# Dancing with the Stars 数据预处理系统说明

## 概述

本数据预处理系统针对《与星共舞》(Dancing with the Stars) 34个赛季的参赛者数据进行全面清洗、特征提取和结构化处理，为后续的粉丝投票估算、争议案例分析和评分制度比较等建模任务提供高质量的数据基础。

## 数据处理流程

### 1. 数据结构识别

- **原始数据规模**: 421行 × 53列，覆盖第1-34赛季
- **评分结构**: 识别44个评委评分列，涵盖第1-11周的比赛数据
- **评委配置**: 每周3-4位评委，动态变化

### 2. 基础数据清洗

- **数据完整性**: 保持100%数据保留率，无重复记录
- **缺失值处理**: 将淘汰后的0分转换为NaN值（共4671个），符合数据说明第7条
- **数据标准化**: 统一选手姓名、舞伴姓名格式，标准化年龄和排名数据

### 3. 评委评分处理

#### 核心评分指标

- **归一化评分比例** (`week{X}_judge_score_ratio`): 解决3位vs4位评委的评分规模差异，归一化到0-1范围
- **评委分歧度** (`week{X}_judge_std`): 计算每周评委评分的标准差，衡量评委意见一致性
- **评分范围** (`week{X}_judge_range`): 每周最高分与最低分的差值

#### 评分趋势分析

- 个人趋势

  : 使用线性回归分析每位选手的评分变化趋势

  - 稳定型: 244位选手 (58.0%)
  - 无明显趋势: 80位选手 (19.0%)
  - 进步型: 30位选手 (7.1%)
  - 数据不足: 61位选手 (14.5%)
  - 下滑型: 6位选手 (1.4%)

- **整体趋势**: 评委评分整体呈上升趋势，每周平均提升0.0338个比例点

#### 最近表现动量

- **两周动量** (`last_2_weeks_momentum`): 捕捉选手最近两周的表现变化，对粉丝投票预测具有重要意义

### 4. 评分制度分析

- **Rank制**: 115位选手（第1-2季和第28-34季）
- **Percent制**: 306位选手（第3-27季）
- **特殊标记**: 第28季后引入评委淘汰机制，第15季为全明星赛季

### 5. 选手特征提取

#### 职业分类（8大类）

- **Screen**: 196人 - 演员、电视主持人等影视从业者
- **Athlete**: 100人 - 各类运动员
- **Music**: 62人 - 歌手、音乐人
- **Other**: 22人 - 其他职业
- **Model**: 17人 - 模特、选美
- **Comedian**: 12人 - 喜剧演员
- **Reality**: 9人 - 真人秀明星、网红
- **Politician**: 3人 - 政治人物

#### 人口统计特征

- **年龄分组**: 分为5个年龄段（25岁以下至55岁以上）
- **地域特征**: 标记是否为美国本土选手
- **性别推断**: 基于姓名进行简单性别分类

### 6. 表现指标计算

- **综合表现**: 平均归一化评分0.739，平均参赛6.6周
- **决赛率**: 102位选手进入决赛（24.2%）
- **评分分布**: 最高分、最低分、分数范围等统计指标

### 7. 舞伴效应分析

#### 舞伴实力指标

- **历史表现** (`historical_avg_rank`, `historical_wins`): 基于所有赛季数据计算舞伴的历史平均排名和获胜次数
- **合作经验** (`partner_experience`): 舞伴的总合作次数

#### 顶级舞伴排名

1. Derek Hough: 6次冠军
2. Valentin Chmerkovskiy: 3次冠军
3. Mark Ballas: 3次冠军
4. Kym Johnson: 2次冠军
5. Cheryl Burke: 2次冠军

### 8. 争议选手识别

#### 题目指定案例（4例全部识别）

- Jerry Rice (第2季): 评委排名与最终排名差异显著
- Billy Ray Cyrus (第4季): 多周评委排名垫底但最终第5名
- Bristol Palin (第11季): 12次评委排名最低但获得第3名
- Bobby Bones (第27季): 评委评分持续偏低但最终夺冠

#### 系统识别争议选手

- **识别标准**: 评委排名与最终排名差异超过3位
- **识别结果**: 16位系统识别的争议选手

### 9. 职业成功率分析

#### 各职业表现对比

- **Reality选手**: 虽然人数最少(9人)，但表现最佳（平均排名5.0，决赛率33.3%）
- **Athlete选手**: 决赛率最高（29.0%），12次夺冠
- **Screen选手**: 夺冠次数最多（14次），但决赛率相对较低（22.4%）
- **Politician选手**: 表现最差（平均排名10.3，无人进入决赛）

### 10. 状态追踪系统

- **Active**: 该周正常参赛
- **Eliminated**: 该周被淘汰
- **Skip**: 该周缺席比赛

为每周生成状态列（`week{X}_status`），便于时间序列建模时处理选手的不同参赛状态。

## 输出文件详细说明

### 1. 主数据文件 (`processed_dwts_data.csv`)

**用途**: 包含所有处理后的选手数据，用于主要建模任务
 **规模**: 421行 × 106列

#### 基础信息列 (12列)

- `celebrity_name`: 选手姓名
- `ballroom_partner`: 职业舞者姓名
- `season`: 参赛赛季编号 (1-34)
- `celebrity_age_during_season`: 选手参赛时年龄
- `celebrity_industry`: 选手原始职业描述
- `celebrity_homecountry/region`: 选手家乡国家/地区
- `results`: 比赛结果描述 (如"1st Place", "Eliminated Week 5")
- `final_placement`: 最终排名 (1为冠军)
- `reached_finale`: 是否进入决赛 (1=是, 0=否)
- `age_group`: 年龄分组 (Under 25, 25-34, 35-44, 45-54, 55+)
- `profession_category`: 职业类别 (Screen/Athlete/Music/Reality/Model/Comedian/Politician/Other)
- `is_us_contestant`: 是否美国选手 (1=是, 0=否)

#### 表现指标列 (8列)

- `overall_avg_score`: 总体平均归一化评分 (0-1范围)
- `max_score`: 最高周归一化评分
- `min_score`: 最低周归一化评分
- `score_range`: 评分范围 (最高分-最低分)
- `weeks_competed`: 参赛周数
- `score_trend_slope`: 评分趋势斜率 (正值表示进步，负值表示下滑)
- `score_trend_r2`: 趋势拟合优度 (0-1，越接近1表示趋势越明显)
- `weeks_with_scores`: 有效评分周数

#### 评委分析列 (4列)

- `trend_category`: 趋势类别 (Improving/Declining/Stable/No_Clear_Trend/Insufficient_Data)
- `avg_judge_disagreement`: 平均评委分歧度 (评分标准差的平均值)
- `max_judge_disagreement`: 最大评委分歧度 (某周评委分歧最大值)
- `avg_judge_range`: 平均评委评分范围 (最高分-最低分的平均值)

#### 舞伴特征列 (5列)

- `partner_experience`: 舞者参赛经验 (合作次数)
- `partner_wins_current`: 舞者当前数据集中的冠军数
- `historical_avg_rank`: 舞者历史平均排名
- `historical_wins`: 舞者历史冠军总数
- `gender`: 选手性别推断 (Male/Female/Unknown)

#### 争议标记列 (3列)

- `is_controversial_case`: 是否为题目提及的争议案例 (1=是, 0=否)
- `is_controversial`: 是否为系统识别的争议选手 (1=是, 0=否)
- `rank_discrepancy`: 评委排名与最终排名差异

#### 赛季特征列 (4列)

- `scoring_system`: 评分机制类型 (Rank/Percent)
- `has_judge_elimination`: 是否有直播评委淘汰 (1=是, 0=否)
- `is_allstar_season`: 是否全明星赛季 (1=是, 0=否)
- `last_2_weeks_momentum`: 最近两周表现动量

#### 每周评分列 (70列，前10周)

每周包含7个指标：

- `week{X}_total`: 每周评委总分
- `week{X}_avg`: 每周评委平均分
- `week{X}_judges`: 每周评委数量
- `week{X}_judge_std`: 每周评委评分标准差
- `week{X}_judge_range`: 每周评委评分范围
- `week{X}_judge_score_ratio`: 每周归一化评分比例 (核心指标)
- `week{X}_status`: 每周参赛状态 (Active/Eliminated/Skip)

### 2. 争议案例文件 (`controversial_cases.csv`)

**用途**: 专门分析争议选手的数据
 **规模**: 20行 × 8列

#### 列结构

- `celebrity_name`: 争议选手姓名
- `season`: 参赛赛季
- `final_placement`: 最终排名
- `overall_avg_score`: 总体平均评分
- `rank_discrepancy`: 评委排名与最终排名差异 (正值表示最终排名好于评委排名)
- `score_trend_slope`: 评分趋势斜率
- `avg_judge_disagreement`: 平均评委分歧度
- `last_2_weeks_momentum`: 最近两周表现动量

#### 数据意义

- 包含题目明确提及的4个争议案例
- 包含系统识别的其他16位争议选手
- 用于分析不同评分机制对争议选手的影响

### 3. 职业分析文件 (`profession_analysis.csv`)

**用途**: 分析不同职业背景选手的成功率
 **规模**: 8行 × 8列 (8个职业类别)

#### 列结构

- `profession_category`: 职业类别 (索引列)
- `count`: 该职业参赛人数
- `avg_placement`: 该职业平均最终排名
- `avg_score`: 该职业平均归一化评分
- `finale_rate`: 该职业决赛率 (进入决赛的比例)
- `avg_judge_disagreement`: 该职业平均评委分歧度
- `avg_score_trend`: 该职业平均评分趋势
- `avg_momentum`: 该职业平均表现动量

#### 应用价值

- 揭示哪些职业背景的选手更容易获得成功
- 分析不同职业选手是否更容易引起评委分歧
- 研究不同职业选手的进步模式差异
- 为分析粉丝投票偏好提供基础数据

### 4. 评委评分分析文件 (`judge_scoring_analysis.csv`)

**用途**: 专门分析评委评分模式和趋势
 **规模**: 421行 × 11列

#### 列结构

- `celebrity_name`: 选手姓名
- `season`: 参赛赛季
- `overall_avg_score`: 总体平均评分
- `final_placement`: 最终排名
- `avg_judge_disagreement`: 平均评委分歧度
- `max_judge_disagreement`: 最大评委分歧度
- `avg_judge_range`: 平均评委评分范围
- `score_trend_slope`: 评分趋势斜率
- `score_trend_r2`: 趋势拟合优度
- `trend_category`: 趋势类别
- `last_2_weeks_momentum`: 最近两周表现动量

#### 分析价值

- 识别哪些选手最容易引起评委分歧
- 分析评委评分的一致性模式
- 研究评分趋势与最终成绩的关系
- 为粉丝投票推算提供评委行为基础数据

### 5. 舞伴分析文件 (`partner_analysis.csv`)

**用途**: 量化舞伴对比赛结果的影响
 **规模**: 约80行 × 7列 (所有舞伴)

#### 列结构

- `ballroom_partner`: 舞伴姓名 (索引列)
- `partnerships_count`: 合作次数
- `avg_placement`: 平均排名
- `avg_score`: 平均评分
- `finale_rate`: 决赛率
- `historical_avg_rank`: 历史平均排名
- `historical_wins`: 历史冠军数

#### 应用价值

- 量化舞伴实力对比赛结果的影响
- 识别最成功的职业舞者
- 为舞伴效应建模提供数据支持

### 6. 周级层次数据 (`week_level_data.json`)

**用途**: 支持时间序列建模和粒子滤波算法
 **格式**: JSON层次结构

#### 数据结构

```json
{
  "S{season}": {
    "Type": "Rank" | "Percent",
    "Weeks": {
      "Week_{week}": {
        "Contestants": ["选手1", "选手2", ...],
        "Judge_Scores": [0.75, 0.82, ...],
        "Features_Matrix": [[age, gender_code, prof_code, partner_exp, partner_rank], ...],
        "Eliminated": ["被淘汰选手"],
        "Survivors": ["幸存选手"]
      }
    }
  }
}
```

#### 特征矩阵说明

每位选手的特征向量包含5个元素：

1. `age`: 选手年龄 (-1表示缺失)
2. `gender_code`: 性别编码 (0=Male, 1=Female, -1=Unknown)
3. `prof_code`: 职业编码 (0-7对应8个职业类别)
4. `partner_exp`: 舞伴经验值
5. `partner_rank`: 舞伴历史平均排名

#### 应用场景

- 粒子滤波算法的时间序列建模
- 动态贝叶斯网络建模
- 马尔可夫链蒙特卡洛方法
- 周级粉丝投票估算

### 7. 评分制度比较文件 (`scoring_system_comparison.csv`)

**用途**: 比较Rank制与Percent制对不同职业选手的影响
 **规模**: 16行 × 6列 (2个制度 × 8个职业)

#### 列结构

- `scoring_system`: 评分制度 (Rank/Percent) - 多级索引第1层
- `profession_category`: 职业类别 - 多级索引第2层
- `count`: 该组合的选手数量
- `avg_placement`: 平均排名
- `avg_score`: 平均评分
- `avg_disagreement`: 平均评委分歧度
- `avg_discrepancy`: 平均排名差异

#### 分析维度

- **制度效应**: 比较同一职业在不同制度下的表现差异
- **职业偏好**: 分析不同制度是否偏向特定职业
- **争议程度**: 评估两种制度产生争议的倾向性

## 数据质量保证

### 完整性指标

- **数据保留率**: 100%
- **特征覆盖率**: 106个特征全面覆盖选手、评委、舞伴、时间等维度
- **时间跨度**: 34个赛季，11周比赛数据

### 准确性保证

- **评分归一化**: 解决不同评委数量的规模差异
- **缺失值处理**: 基于业务逻辑正确处理淘汰后评分
- **争议案例验证**: 100%识别题目指定的4个争议案例

### 建模友好性

- **数值特征**: 归一化评分、趋势指标、动量特征
- **分类特征**: 简化的职业分类、评分制度标记
- **时间序列支持**: 周级层次数据结构
- **状态追踪**: 完整的选手参赛状态记录

## 应用场景

1. **粉丝投票估算**: 利用评委评分、选手特征、舞伴效应等预测粉丝投票
2. **争议案例分析**: 深入研究评委与粉丝意见分歧的原因和模式
3. **评分制度比较**: 量化分析Rank制与Percent制的差异和影响
4. **时间序列建模**: 使用周级数据进行动态建模和预测
5. **特征重要性分析**: 识别影响比赛结果的关键因素

本预处理系统为MCM Problem C的核心分析任务提供了全面、准确、结构化的数据基础，支持多种建模方法和分析角度。
